## 2025年7月14日-学习项目结构，用户管理系统项目初始化

学习go语言的项目布局，包括标准布局方法和Clean Architecture方法

- [Go 项目标准布局](https://github.com/golang-standards/project-layout)

- [Clean Architecture in Go](https://manuel.kiessling.net/2012/09/28/applying-the-clean-architecture-to-go-applications/)

1.**项目结构搭建**

采用Clean Architecture分层：

![image-20250714181311898](https://my-typora329.oss-cn-beijing.aliyuncs.com/image-20250714181311898.png)

```
  user-management/
  ├── cmd/
  │   └── server/
  │       └── main.go       # 入口文件
  ├── internal/
  │   ├── handler/          # HTTP处理层
  │   ├── service/          # 业务逻辑层
  │   ├── repository/       # 数据访问层
  │   └── model/            # 数据模型
  ├── pkg/
  │   └── util/             # 工具函数
  ├── configs/              # 配置文件
  ├── api/                  # API文档
  ├── scripts/              # 部署脚本
  ├── test/                 # 集成测试
  └── go.mod
```

大体的业务处理如下，分析：

1. **User**（Model）：定义了一个简单的用户数据结构。
2. **UserRepository**（Repository）：定义了一个简单的仓库，负责从数据库（此处模拟）中获取数据。
3. **UserService**（Service）：包含业务逻辑，调用 `UserRepository` 来获取用户数据。
4. **UserHandler**（Handler）：接收请求并返回响应，调用 `UserService` 获取数据。

### 依赖注入是什么？

**依赖注入（Dependency Injection，DI）**

依赖注入（DI）是一种设计模式，用于减少对象之间的耦合度，改善代码的可测试性、可维护性和可扩展性。简单来说，依赖注入的核心思想是将对象所依赖的其他对象（即“依赖”）通过构造函数、属性或方法注入给该对象，而不是在对象内部创建这些依赖。这样可以使得对象与其依赖关系解耦，便于替换、测试和维护。

**依赖注入过程**：

- `UserHandler` 依赖 `UserService`。
- `UserService` 依赖 `UserRepository`。
- `UserRepository` 是一个独立的结构，它与数据库交互。

所有这些依赖关系是通过构造函数传递的，也就是**构造函数注入**。在 `main` 函数中，我们按顺序创建了 `UserRepository`，`UserService` 和 `UserHandler`，并将它们注入到下一个依赖层中。

<img src="https://my-typora329.oss-cn-beijing.aliyuncs.com/deepseek_mermaid_20250714_d44c96.png" alt="deepseek_mermaid_20250714_d44c96" style="zoom: 25%;" />

AI编写了index.html和register.html，可以实现用户的**注册功能**



## 2025年7月15日-Viper配置管理，MySQL

### 什么是配置管理？

配置管理（Configuration Management）是指在系统或软件的全生命周期中，对所有配置项（如参数、设置、文件、依赖等）进行**识别、记录、追踪、控制和维护**的过程，目的是确保系统配置的一致性、可追溯性和可靠性，减少因配置混乱导致的错误或故障。

用Viper配置在生产、开发、测试环境的不同参数，封存敏感信息，使用环境变量注入

MySQL用户设置、管理MySQL的命令、MySQ连接、创建、增删查改数据库、增删查改数据表等命令



## 2025年7月16日-Zap日志库

**Zap** 是一个由 Uber 开源的高性能日志库，主要用于 Go 语言（Golang）项目。它以**极致的性能**和**结构化日志支持**为核心特点，广泛应用于对日志输出效率有较高要求的后端服务场景。



## 2025年7月17日-错误处理与恢复机制

1. 实现全局错误处理中间件
2. 设计自定义错误类型
3. 集成错误日志记录
4. 实现应用恢复机制
5. 创建统一错误响应格式



## 2025年7月18日-API文档与测试

使用Swagger生成API文档，实现接口单元测试，创建了集成测试套件，实现了测试覆盖率分析

只实现了注册功能的部分

<img src="https://my-typora329.oss-cn-beijing.aliyuncs.com/image-20250718173850159.png" alt="image-20250718173850159" style="zoom:50%;" />



## 2025年7月23日-JWT身份认证

**JWT** 是一个用于在各方之间安全传递声明的开放标准（RFC 7519）。它常用于身份认证和信息交换。

JWT 由三部分组成：

1. **Header（头部）**：

   - 头部通常由两部分组成：令牌的类型（通常是 `JWT`）和所使用的签名算法（如 `HS256`）。

   - 示例：

     ```json
     json复制编辑{
       "alg": "HS256",
       "typ": "JWT"
     }
     ```

2. **Payload（有效载荷）**：

   - Payload 存储声明。声明可以分为三种：注册声明（如 `sub`, `iat`）、公共声明和私有声明。

   - 示例：

     ```json
     json复制编辑{
       "sub": "1234567890",
       "name": "John Doe",
       "iat": 1516239022
     }
     ```

3. **Signature（签名）**：

   - 签名是为了确保令牌没有被篡改。使用头部中指定的算法（如 `HS256`），将 `header` 和 `payload` 用密钥加密。

   - 示例：

     ```plaintext
     plaintext复制编辑HMACSHA256(
       base64UrlEncode(header) + "." + base64UrlEncode(payload),
       your-256-bit-secret
     )
     ```

     

## 2025年7月24日-API安全

**CORS 跨域配置**：

- 配置 CORS，允许外部客户端与 API 进行安全交互。
- 在服务器端添加正确的 CORS 头部，控制允许哪些来源的请求访问你的 API。

**CORS**（Cross-Origin Resource Sharing）是浏览器的一种安全功能，它阻止网页跨域请求不同源的资源。CORS 允许你控制哪些域名可以访问你的 API。

由于你可能会在本地开发时使用不同的前端和后端端口（例如，前端在 `localhost:3000`，后端在 `localhost:8080`），因此你需要配置 CORS 来允许前端与后端的通信。

### http VS Websocket：

**相似**：都基于tcp，两者兼容性好，端口一样，`ws`在握手阶段采用`http`

**不同**：`http`半双工，ws全双工。`http`只能由`client`向`serve`r主动发起请求，`ws`可以由`server`主动向`client`推送。`http`长连接每次请求都要带上`header`，`ws`在数据传输过程中不需要。

`WebSocket`主要用于多人游戏、聊天室、协同编辑、实时报价等需要实时更新内容的场景



## 2025年7月25日-Web编程的原理

客户端向服务端发送请求，服务端接受通过URL给到多路复用器，多路复用器转发请求到处理器，不同处理器通过模型（model）和数据库通信，返回处理器，处理器把信息交给模板引擎生成HTML文件返回给客户端。



2025年7月26日-复习go基础
